<script type="text/javascript">
	$('#tabs').puitabview({
		change: function(event, ui) {  
			verbergMeldingen();
	    } 
	});

	function Relatie(data) {
	    var self = this;
	    
		this.id = ko.observable(data.id);
		this.voornaam = ko.observable(data.voornaam);
		this.achternaam = ko.observable(data.achternaam);
		this.tussenvoegsel = ko.observable(data.tussenvoegsel);
		this.straat = ko.observable(data.straat);
		this.huisnummer = ko.observable(data.huisnummer);
		this.toevoeging = ko.observable(data.toevoeging);
		this.postcode = ko.observable(data.postcode);
		this.plaats = ko.observable(data.plaats);
		this.bsn = ko.observable(data.bsn);
		this.identificatie = ko.observable(data.identificatie);
		this.zakelijkeKlant = ko.observable(data.zakelijkeKlant);
		if(this.zakelijkeKlant){
			$('#tabs').puitabview('enable' , 1);
		}else{
			$('#tabs').puitabview('disable' , 1);
		}
		this.rekeningnummers = ko.observableArray();
		if(data.rekeningnummer!=null){
			$.each(data.rekeningnummers, function(i, item) {
				self.rekeningnummers.push(new RekeningNummer(item));
			});
		}
		this.telefoonnummers = ko.observableArray();
		if(data.telefoonnummers != null){
			$.each(data.telefoonnummers, function(i, item) {
				self.telefoonnummers.push(new TelefoonNummer(item));
			});
		}
		this.bedrijven = ko.observableArray();
		if(data.bedrijven != null){
			$.each(data.bedrijven, function(i, item) {
				self.bedrijven.push(new Bedrijf(item));
			});
		}
		this.bedrijvenVoorPolis = ko.observableArray();
		if(data.bedrijven != null){
			self.bedrijvenVoorPolis.push(new Bedrijf({id: 0, naam: 'Kies een bedrijf'}));
			$.each(data.bedrijven, function(i, item) {
				self.bedrijvenVoorPolis.push(new Bedrijf(item));
			});
		}
		this.polisVoorSchademelding = ko.observableArray();
		if(data.polissen != null){
			self.polisVoorSchademelding.push(new Polis({id: 0, soort: 'Kies een polis uit de lijst', maatschappij : 0}));
			$.each(data.polissen, function(i, item) {
				self.polisVoorSchademelding.push(new Polis(item));
			});
		}

		this.geboorteDatum = ko.observable(data.geboorteDatumOpgemaakt);
		this.overlijdensdatum = ko.observable(data.overlijdensdatumOpgemaakt);
		this.geslacht = ko.observable(data.geslacht);
		this.burgerlijkeStaat = ko.observable(data.burgerlijkeStaat);
	
		this.onderlingeRelaties = ko.observableArray();
		/*		if(data.onderlingeRelaties != null){
			$.each(data.onderlingeRelaties, function(i, item) {
				self.onderlingeRelaties.push(new OnderlingeRelatie(item));
	 		});
		}
		*/
		this.polissen = ko.observableArray();
 		if(data.polissen != null){
			$.each(data.polissen, function(i, item){
				self.polissen.push(new Polis(item));
			})
		}
 		this.lijstBijlages = ko.observableArray();
 		if(data.lijstBijlages != null){
			$.each(data.lijstBijlages, function(i, item){
				self.lijstBijlages.push(new Bijlage(item));
			})
 		}
		this.voegRekeningToe = function() {
	        self.rekeningnummers.push(new RekeningNummer(""));
	    };
	    
	    this.verwijderRekening = function(nummer){
	    	self.rekeningnummers.remove(nummer);
	    }
	    
	    this.voegTelefoonNummerToe = function() {
	    	self.telefoonnummers.push(new TelefoonNummer(""));
	    }
	    
	    this.verwijderTelefoonNummer = function(telefoon) {
	    	self.telefoonnummers.remove(telefoon);
	    }
	    
		this.schades = ko.observableArray();
		if(data.schades != null){
			$.each(data.schades, function(i, item) {
				self.schades.push(new Schade(item));
			});
		}
	    
	    this.voegPolisToe = function(){
	    	var ingangsDatum = moment($('#ingangsDatumString').val(), "DD-MM-YYYY").format("YYYY-MM-DD");
	    	var wijzigingsDatum = moment($('#wijzigingsdatumString').val(), "DD-MM-YYYY").format("YYYY-MM-DD");
	    	var prolongatieDatum = moment($('#prolongatiedatumString').val(), "DD-MM-YYYY").format("YYYY-MM-DD");
	    	self.polissen.push(new Polis({
            	premie : $('#premie').val().replace(",", "."),
				maatschappij : $('#verzekeringsMaatschappijen').val(),
				soort : $('#soortVerzekering').val(),
				polisNummer : $('#polisNummer').val(),
				ingangsDatum : ingangsDatum,
				wijzigingsDatum : wijzigingsDatum,
				prolongatieDatum : prolongatieDatum,
				bedrijf : $('#bedrijfBijPolis').val(),
				betaalfrequentie : $('#betaalfrequentie').val()
	    	}));
			$('#tabs').puitabview('select', 2);
	    }

	    this.verwijderPolis = function(polis){
			var r=confirm("Weet je zeker dat je deze polis wilt verwijderen?");
			if (r==true) {
				self.polissen.remove(polis);
				$.get( "../dejonge/rest/medewerker/polis/verwijder", {"id" : ko.utils.unwrapObservable(polis.id)}, function( data ) {});
			}
	    }
	    
	    this.schadeMeldenBijPolis = function(polis){
			$('#tabs').puitabview('select', 6);
			console.log(ko.utils.unwrapObservable(polis.id));
			console.log($('#polisVoorSchademelding').val());
			$('#polisVoorSchademelding').val(ko.utils.unwrapObservable(polis.id));
	    }
	    
	    self.toevoegenBedrijf = function(){
	    	self.bedrijven.push(new Bedrijf({
            	naam : $('#naamBedrijf').val(),
            	kvk : $('#kvkBedrijf').val(),
            	straat : $('#straatBedrijf').val(),
            	huisnummer : $('#huisnummerBedrijf').val(),
            	toevoeging : $('#toevoegingBedrijf').val(),
            	postcode : $('#postcodeBedrijf').val(),
            	plaats : $('#plaatsBedrijf').val()
	    	}));
	    	self.bedrijvenVoorPolis.push(new Bedrijf({
            	naam : $('#naamBedrijf').val(),
            	kvk : $('#kvkBedrijf').val(),
            	straat : $('#straatBedrijf').val(),
            	huisnummer : $('#huisnummerBedrijf').val(),
            	toevoeging : $('#toevoegingBedrijf').val(),
            	postcode : $('#postcodeBedrijf').val(),
            	plaats : $('#plaatsBedrijf').val()
	    	}));
	    }
	    
	    
	    self.userClick = function (obj) {
	        document.location.hash='#beherenRelatie/' + ko.utils.unwrapObservable(obj.idNaar);
	    }
	    
	    this.opslaan = function(){
	    	verbergMeldingen();
	    	if(ko.utils.unwrapObservable(this.geboorteDatum) != null && ko.utils.unwrapObservable(this.geboorteDatum) != ''){
	    		this.geboorteDatum(moment(ko.utils.unwrapObservable(this.geboorteDatum), "DD-MM-YYYY").format("YYYY-MM-DD"));
	    	}
	    	if(ko.utils.unwrapObservable(this.overlijdensdatum) != null && ko.utils.unwrapObservable(this.overlijdensdatum) != ''){
	    		this.overlijdensdatum(moment(ko.utils.unwrapObservable(this.overlijdensdatum), "DD-MM-YYYY").format("YYYY-MM-DD"));
	    	}
	    	$.ajax({
	            url: '../dejonge/rest/medewerker/gebruiker/opslaan',
	            type: 'POST',
	            data: ko.toJSON(this) ,
	            contentType: 'application/json; charset=utf-8',
	            success: function (response) {
					document.location.hash='#lijstRelaties';
	            	plaatsMelding("De gegevens zijn opgeslagen");
	            },
	            error: function (data) {
	            	plaatsFoutmelding(data);
	            }
	        });
	    	if(ko.utils.unwrapObservable(this.geboorteDatum) != null && ko.utils.unwrapObservable(this.geboorteDatum) != ''){
		    	this.geboorteDatum(moment(ko.utils.unwrapObservable(this.geboorteDatum), "YYYY-MM-DD").format("DD-MM-YYYY"));
	    	}
	    	if(ko.utils.unwrapObservable(this.overlijdensdatum) != null && ko.utils.unwrapObservable(this.overlijdensdatum) != ''){
		    	this.overlijdensdatum(moment(ko.utils.unwrapObservable(this.overlijdensdatum), "YYYY-MM-DD").format("DD-MM-YYYY"));
			}
	    }
	    
	    this.verwijderenRelatie = function(obj){
			$.ajax({
				type: "GET",
				url: '../dejonge/rest/medewerker/gebruiker/verwijderen',
				dataType:'json',
				data: {
					id : ko.utils.unwrapObservable(obj.id)
				}
			});
			document.location.hash='#lijstRelaties';
	    }
	}
	
	function OnderlingeRelatie(data){
		this.id = ko.observable(data.id);
		this.idNaar = ko.observable(data.idNaar);
		this.metWie = ko.observable(data.metWie);
		this.soort = ko.observable(data.soort);
	}
	
	function RekeningNummer(data){
		this.id = ko.observable(data.id);
		this.rekeningnummer = ko.observable(data.rekeningnummer);
		this.bic = ko.observable(data.bic);
	}
	
	function TelefoonNummer(data){
		this.id = ko.observable(data.id);
		this.telefoonnummer = ko.observable(data.telefoonnummer);
		this.soort = ko.observable(data.soort);
	}
	
	function Bedrijf(data){
	    this.id = ko.observable(data.id);
	    this.polissen = ko.observableArray();
 		if(data.polissen != null){
			$.each(data.polissen, function(i, item){
				self.polissen.push(new Polis(item));
			})
 		}
	    this.naam = ko.observable(data.naam);
	    this.kvk = ko.observable(data.kvk);
	    this.straat = ko.observable(data.straat);
	    this.huisnummer = ko.observable(data.huisnummer);
	    this.toevoeging = ko.observable(data.toevoeging);
	    this.postcode = ko.observable(data.postcode);
	    this.plaats = ko.observable(data.plaats);
	}
	
	function Schade(data){
		var self = this;
		
	    self.id = ko.observable(data.id);
	    self.polis = ko.observable(data.polis);
	    self.schadeNummerMaatschappij = ko.observable(data.schadeNummerMaatschappij);
	    self.schadeNummerTussenPersoon = ko.observable(data.schadeNummerTussenPersoon);
	    self.soortSchade = ko.observable(data.soortSchade);
	    self.locatie = ko.observable(data.locatie);
	    self.statusSchade = ko.observable(data.statusSchade);
	    self.datumTijdSchade = ko.observable(data.datumTijdSchade);
	    self.datumTijdMelding = ko.observable(data.datumTijdMelding);
	    self.datumAfgehandeld = ko.observable(data.datumAfgehandeld);
	    self.eigenRisico = ko.observable(data.eigenRisico);
	    self.omschrijving = ko.observable(data.omschrijving);
	    
		self.idDiv = ko.computed(function() {
	        return "collapsableSchade" + data.id;
		}, this);
		self.idDivLink = ko.computed(function() {
	        return "#collapsableSchade" + data.id;
		}, this);

	    this.opmerkingen = ko.observableArray();
 		if(data.opmerkingen != null){
			$.each(data.opmerkingen, function(i, item){
				self.opmerkingen.push(new Opmerking(item));
			})
 		}
	}
	
	function Opmerking(data){
		var self = this;
		
	    self.id = ko.observable(data.id);
	    self.tijd = ko.observable(data.tijd);
	    self.opmerking = ko.observable(data.opmerking);
	    self.medewerker = ko.observable(data.medewerker);
	}
	
	function Polis(data){
		var self = this;
	
		self.id = ko.observable(data.id);
		self.omschrijving = ko.observable(data.omschrijving);
		self.polisNummer = ko.observable(data.polisNummer);
		self.ingangsDatum = ko.observable(moment(data.ingangsDatum).format("DD-MM-YYYY"));
		self.prolongatieDatum = ko.observable(moment(data.prolongatieDatum).format("DD-MM-YYYY"));
		self.wijzigingsDatum = ko.observable(moment(data.wijzigingsDatum).format("DD-MM-YYYY"));
		self.maatschappij = ko.observable(data.maatschappij.naam);
		self.soort = ko.observable(data.soort);
		self.premie = ko.observable(data.premie);
		self.betaalfrequentie = ko.observable(data.betaalfrequentie);
		self.bedrijf = ko.observable(data.bedrijf);
		self.idDiv = ko.computed(function() {
	        return "collapsable" + data.id;
		}, this);
		self.idDivLink = ko.computed(function() {
	        return "#collapsable" + data.id;
		}, this);
		self.className = ko.computed(function() {
			var datum = moment(data.ingangsDatum);
			var tijd = moment(datum).fromNow();
			if(tijd.substr(tijd.length - 3) == "ago"){
				return "panel-title";
			}else{
				return "polisNietActief panel-title";
			}
		}, this);

		self.bijlages = ko.observableArray();
		if(data.bijlages != null){
			$.each(data.bijlages, function(i, item){
				self.bijlages.push(new Bijlage(item));
			})
		}
	}
	
	function Polissen(data){
		var self = this;
		
		self.polissen = ko.observableArray();
		$.each(data, function(i, item){
			self.polissen.push(new Polis(item));
		})
	}
	
	function Bijlage(data){
		var self = this;
	
		self.url = ko.computed(function() {
	        return "../dejonge/rest/medewerker/bijlage/download?bijlageId=" + data.id;
		}, this);
		self.bestandsNaam = ko.observable(data.bestandsNaam);
		self.soortBijlage = ko.observable(data.soortBijlage);
	}
	
	
	function start(){
		var bestPictures = new Bloodhound({
			datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
			queryTokenizer: Bloodhound.tokenizers.whitespace,
			remote: '../dejonge/rest/medewerker/overig/soortenSchade?query=%QUERY'
		});
		
		bestPictures.initialize();
		
		$('#soortSchade').typeahead({
			hint: true,
			highlight: true,
			minLength: 1
		},
		{
			name: 'states',
			displayKey: 'value',
			source: bestPictures.ttAdapter()
		});

		$.ajax({
			type: "GET",
			url: '../dejonge/rest/medewerker/overig/lijstVerzekeringsMaatschappijen',
			dataType: "json",
			context: this,
			success: function(data) {
				var $select = $('#verzekeringsMaatschappijen');
				$.each(data, function(key, value) {
				    $('<option>').text(value).appendTo($select);
				});
			}
		});
		$.ajax({
			type: "GET",
			url: '../dejonge/rest/medewerker/overig/lijstStatusSchade',
			dataType: "json",
			context: this,
			success: function(data) {
				var $select = $('#statusSchade');
				$.each(data, function(key, value) {
				    $('<option>').text(value).appendTo($select);
				});
			}
		});
		$.get( "../dejonge/rest/medewerker/gebruiker/lees", {"id" : $('#id').val()}, function( data ) {
           	ko.applyBindings(new Relatie(data));
	    });
		$('#soortVerzekering').change(function() {
 			$('#div_kenteken').hide();
			$('#div_soortAutoVerzekering').hide();
			$('#div_oldtimer').hide();

			if($('#soortVerzekering').val() == "Auto"){
				$('#div_kenteken').show();
				$('#div_soortAutoVerzekering').show();
			}

			if($('#soortVerzekering').val() == "Motor"){
				$('#div_kenteken').show();
				$('#div_oldtimer').show();
			}

		});
 
		$("#lijstRelaties").puidatatable({
	        caption: "Lijst Relaties" + $('#zoekCriteriaLijstRelaties').val(),  
	        columns: [
	            {field:"achternaam", headerText: "Achternaam", sortable:true},
	            {field:"tussenvoegsel", headerText: "Tussenvoegsel", sortable:true},
	            {field:"voornaam", headerText: "Voornaam", sortable:true},
	            {field:"geboortedatum", headerText: "Geboortedatum", sortable:true},
	            {field:"adresOpgemaakt", headerText: "Straat", sortable:true},
	            {field:"bsn", headerText: "Bsn", sortable:true}
	        ],  
	        datasource: function(callback) {
	            $.ajax({  
	                type: "GET",  
	                url: '../dejonge/rest/medewerker/gebruiker/lijstRelaties',
					data: {
						weglaten : $('#id').val(),
	   					criteria : $('#zoekCriteriaLijstRelaties').val()
					},
	                dataType: "json",  
	                context: this,  
	                success: function(response) {  
	                    callback.call(this, response);  
	                }  
	            });  
	        }, 
	        selectionMode: "single",
	        rowSelect: function(event, data) {
	            $.ajax({  
	                type: "GET",  
	                url: '../dejonge/rest/medewerker/gebruiker/toevoegenRelatieRelatie',
					data: {
						idToeTeVoegen : data.id,
	   					idAanToevoegen : $('#id').val(),
	   					soortRelatie : $('#soortRelatie').val()
					},
	                dataType: "json",  
	                context: this,  
	                success: function(data) {
	    	 			if($.type(data) == "string"){
								addMessage([{severity: 'error', summary: 'Er is een fout opgetreden', detail: response}]);  
	                	}else{
	                    	$('#dlg').puidialog('hide');
	    		           	ko.applyBindings(new Relatie(data));
	                	}
	                }  
	        })
	        }
	    });
	}

/* 	ko.applyBindings(new Relatie());
*/</script>
<div id="tabs">
	<ul>
		<li><a href="#relatieGegevens">Relatie Gegevens</a></li>
		<li><a href="#zakelijkeGegevens">Zakelijke Gegevens</a></li>
		<li><a href="#polissen">Polissen</a></li>
		<li><a href="#toevoegenPolis">Toevoegen Polis</a></li>
		<li><a href="overizchtBijlages">Overzicht Bijlages</a></li>
		<li><a href="schades">Schades</a></li>
		<li><a href="schademelden">Schade Melden</a></li>
	</ul>
		<div>
		<div id="relatieGegevens">
			<input class="form-control" type="hidden" id="id" name="id" data-bind="value: id" />
			<div class="form-group">
				<label for="zakelijkeklant">Zakelijke klant</label>
				<input class="form-control" type="checkbox" id="zakelijkeklant" name="zakelijkeklant" data-bind="checked: zakelijkeklant" />
				<script>
					$('#zakelijkeklant').change(function(){
						if($('#zakelijkeklant').is(':checked')){
							$('#tabs').puitabview('enable' , 1);
						}else{
							$('#tabs').puitabview('disable' , 1);
						}
					});
				</script>
			</div>
			<div class="form-group">
				<h3>Persoonsgegevens</h3>
			</div>
			<div class="form-group">
				<label for="voornaam">Voornaam</label>
				<input class="form-control" type="text" id="voornaam" name="voornaam" data-bind="value: voornaam" />
			</div>
			<div class="form-group">
				<label for="tussenvoegsel">Tussenvoegsel</label>
				<input class="form-control" type="text" id="tussenvoegsel" name="tussenvoegsel" data-bind="value: tussenvoegsel" />
			</div>
			<div class="form-group">
				<label for="achternaam">Achternaam</label>
				<input class="form-control" type="text" id="achternaam" name="achternaam"data-bind="value: achternaam"  />
			</div>
			<div class="form-group">
				<label for="bsn">Bsn</label>
				<input class="form-control" type="text" id="bsn" name="bsn" data-bind="value: bsn" />
			</div>
			<div class="form-group">
				<label for="geboorteDatum">Geboortedatum</label>
				<input class="form-control" type="text" id="geboorteDatum" name="geboorteDatum" data-bind="value: geboorteDatum" />
			</div>
			<div class="form-group">
				<label for="overlijdensdatum">Overlijdensdatum</label>
				<input class="form-control" type="text" id="overlijdensdatum" name="overlijdensdatum" data-bind="value: overlijdensdatum" />
			</div>
			<div class="form-group">
				<label for="geslacht">Geslacht</label>
				<select id="geslacht" id="geslacht" name="geslacht" data-bind="value: geslacht">
					<option value="Man">Man</option>
					<option value="Vrouw">Vrouw</option>
				</select>
			</div>
			<div class="form-group">
				<label for="burgerlijkeStaat">Burgerlijke staat</label>
				<select id="burgerlijkeStaat" name="burgerlijkeStaat" data-bind="value: burgerlijkeStaat">
					<option value="Ongehuwd">Ongehuwd</option>
					<option value="Gehuwd">Gehuwd</option>
				</select>
			</div>
			<!--span class="glyphicon glyphicon-plus" onclick="$('#dlg').puidialog('show');"></span-->
			<!--div id="relaties" data-bind="foreach: onderlingeRelaties, visible: onderlingeRelaties().length > 0">
				<input type="hidden" id="telefoonid" data-bind="value: id" /-->
				<!--a onclick="document.location.hash='#beherenRelatie/'"-->
				<!--span class="user-box-name" data-bind="text: metWie, click: $root.userClick" style="cursor:pointer;"></span>
				<span data-bind="text: soort"></span>
				<br /-->
			<!--/div-->
			<!--div id="dlg" title="Zoek een relatie">  
			    <input class="form-control" type="text" id="zoekRelatie" />
			    <select id="soortRelatie" >
					<option value="">Selecteer een optie...</option>
					<option value="O">Ouder</option>
					<option value="K">Kind</option>
					<option value="W">Werknemer</option>
					<option value="WG">Werkgever</option>
			    </select>
			    <div id="lijstRelaties"></div>
			</div--> 
			
			<div class="form-group">
				<h3>Adresgegevens</h3>
			</div>
			<div class="form-group">
				<label for="straat">Straat</label>
				<input class="form-control" type="text" id="straat" name="straat" data-bind="value: straat" />
			</div>
			<div class="form-group">
				<label for="huisnummer">Huisnummer</label>
				<input class="form-control" type="text" id="huisnummer" name="huisnummer" data-bind="value: huisnummer" />
			</div>
			<div class="form-group">
				<label for="toevoeging">Toevoeging</label>
				<input class="form-control" type="text" id="toevoeging" name="toevoeging" data-bind="value: toevoeging" />
			</div>
			<div class="form-group">
				<label for="postcode">Postcode</label>
				<input class="form-control" type="text" id="postcode" name="postcode" data-bind="value: postcode" />
			</div>
			<div class="form-group">
				<label for="plaats">Plaats</label>
				<input class="form-control" type="text" id="plaats" name="plaats" data-bind="value: plaats" />
			</div>
			
			<div class="form-group">
				<b>Rekeninggegevens</b>&nbsp;<span class="glyphicon glyphicon-plus" data-bind="click: voegRekeningToe" href="#" id="voegRekeningToe"></span>
				<div id="rekeningnummers" data-bind="foreach: rekeningnummers, visible: rekeningnummers().length > 0">
					<div id="rekeningnummer">
						<input class="form-control" type="hidden" id="rekeningid" name="rekeningid" data-bind="value: id" />
						<div class="form-group">
							<label for="rekeningnummer">Rekeningnummer</label>
							<input class="form-control" type="text" id="rekeningnummer" name="rekeningnummer" data-bind="value: rekeningnummer" />
						</div>
						<div class="form-group">
							<label for="bic">Bic</label>
							<input class="form-control" type="text" id="bic" name="bic" data-bind="value: bic" />
						</div>
						<span class="glyphicon glyphicon-minus" data-bind="click: $parent.verwijderRekening" name="verwijderRekening"></span>
					</div>
				</div>
			</div>
			
			<div class="form-group">
				<b>Telefoongegevens</b>&nbsp;<span class="glyphicon glyphicon-plus" data-bind="click: voegTelefoonNummerToe" href="#" id="voegTelefoonNummerToe"></span>
			</div>
			<div id="telefoonnummers" data-bind="foreach: telefoonnummers, visible: telefoonnummers().length > 0">
				<div id="telefoonnummer">
					<input class="form-control" type="hidden" name="telefoonid" id="telefoonid" data-bind="value: id" />
					<div class="form-group">
						<label for="telnummer">Telefoonnummer</label>
						<input class="form-control" type="text" id="telnummer" name="telnummer" data-bind="value: telefoonnummer" />
					</div>
					<div class="form-group">
						<label for="soorttelnummer">Soort</label>
						<select id="soorttelnummer" name="soorttelnummer" data-bind="value: soort">
							<option value="Mobiel">Mobiel</option>
							<option value="Vast">Prive</option>
							<option value="Werk">Zakelijk</option>
						</select>
					</div>
					<span class="glyphicon glyphicon-minus" data-bind="click: $parent.verwijderTelefoonNummer" name="verwijderTelefoonNummer"></span>
				</div>
			</div>
			<div class="form-group">
				<label for="emailadres">E-mailadres</label>
				<input class="form-control" type="text" id="emailadres" name="emailadres" data-bind="value: identificatie" />
			</div>
			<div class="form-group">
				<label for="opslaanrelatie">&nbsp;</label>
				<button id="opslaanrelatie" name="opslaanrelatie" data-bind="click: opslaan">Opslaan</button>
				<span style="cursor:pointer;" id="verwijderen" data-bind="click: verwijderenRelatie">Verwijderen</span>
			</div>
		</div>
		<div id="zakelijkeGegevens">
			<h2>Gegevens van de bedrijven</h2>
			<div id="bedrijven" data-bind="foreach: bedrijven, visible: bedrijven().length > 0">
				<h3 data-bind="text: naam"></h3>
   				<div data-bind="if: kvk">
					<span class="polisLabel">Kvk :</span>
   					<span data-bind="text: kvk"></span>
   				</div>
   				<div data-bind="if: straat">
					<span class="polisLabel">Straat :</span>
   					<span data-bind="text: straat"></span>
   				</div>
   				<div data-bind="if: huisnummer">
					<span class="polisLabel">Huisnummer :</span>
   					<span data-bind="text: huisnummer"></span>
   				</div>
   				<div data-bind="if: toevoeging">
					<span class="polisLabel">Toevoeging :</span>
   					<span data-bind="text: toevoeging"></span>
   				</div>
   				<div data-bind="if: postcode">
					<span class="polisLabel">Postcode :</span>
   					<span data-bind="text: postcode"></span>
   				</div>
   				<div data-bind="if: plaats">
					<span class="polisLabel">Plaats :</span>
	   				<span data-bind="text: plaats"></span>
   				</div>
			</div>
			<h2>Bedrijf toevoegen</h2>
			<input type="text" id="naamBedrijf" placeholder="Naam..." /><br />
			<input type="text" id="kvkBedrijf" placeholder="Kvk..." /><br />
			<input type="text" id="straatBedrijf" placeholder="Straat..." /><br />
			<input type="text" id="huisnummerBedrijf" placeholder="Huisnummer..." /><br />
			<input type="text" id="toevoegingBedrijf" placeholder="Toevoeging..." /><br />
			<input type="text" id="postcodeBedrijf" placeholder="Postcode..." /><br />
			<input type="text" id="plaatsBedrijf" placeholder="Plaats..." /><br />
			<button id="opslaanBedrijf" data-bind="click: $root.toevoegenBedrijf">Opslaan</button>
			<script>
				$('#opslaanBedrijf').click(function(){
			    	verbergMeldingen();
	            	var bedrijf = {
		            	relatie : $('#id').val(),
		            	naam : $('#naamBedrijf').val(),
 		            	kvk : $('#kvkBedrijf').val(),
		            	straat : $('#straatBedrijf').val(),
		            	huisnummer : $('#huisnummerBedrijf').val(),
		            	toevoeging : $('#toevoegingBedrijf').val(),
		            	postcode : $('#postcodeBedrijf').val(),
		            	plaats : $('#plaatsBedrijf').val()
	            	}
	            	var json = JSON.stringify(bedrijf);
					$.ajax({
						type: "POST",
						url: '../dejonge/rest/medewerker/gebruiker/opslaanBedrijf',
						contentType: "application/json",
			            data: json,
			            success: function (response) {
			            	plaatsMelding("De gegevens zijn opgeslagen");
			            },
			            error: function (data) {
			            	plaatsFoutmelding(data);
			            }
			    	});
				});
			</script>
		</div>
		<div id="polissen">
			<div id="polissenHerhaal" data-bind="foreach: polissen, visible: polissen().length > 0">
				<div class="panel-group" id="accordion">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 data-bind="attr:{class: className}">
								<a data-toggle="collapse" data-parent="#accordion" data-bind="attr:{href: idDivLink}, text: soort"></a>
								&nbsp;&nbsp;&nbsp;
								<div class="btn-group">
									<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
										Kies een actie <span class="caret"></span>
									</button>
									<ul class="dropdown-menu" role="menu">
										<li>
											<span class="glyphicon glyphicon-pencil" style="cursor:pointer;" data-bind="click: $root.schadeMeldenBijPolis"></span>
											<span style="cursor:pointer;" data-bind="click: $root.schadeMeldenBijPolis">Bewerken</span>
										</li>
										<li>
											<span class="glyphicon glyphicon-thumbs-down" style="cursor:pointer;" data-bind="click: $root.schadeMeldenBijPolis"></span>
											<span style="cursor:pointer;" data-bind="click: $root.schadeMeldenBijPolis">Schade melden</span>
										</li>
										<li class="divider"></li>
										<li>
											<span class="glyphicon glyphicon-trash" style="cursor:pointer;" data-bind="click: $root.verwijderPolis"></span>
											<span style="cursor:pointer;" data-bind="click: $root.verwijderPolis">Verwijderen</span>
										</li>
									</ul>
								</div>
							</h4>
						</div>
						<div data-bind="attr:{id: idDiv}" class="panel-collapse collapse">
							<div class="panel-body">
								<div data-bind="if: polisNummer">
									<span class="polisLabel">Polisnummer :</span>
									<span data-bind="text: polisNummer"></span>
								</div>
								<div data-bind="if: ingangsDatum">
									<span class="polisLabel">Ingangsdatum :</span>
									<span data-bind="text: ingangsDatum"></span>
								</div>
								<div data-bind="if: wijzigingsDatum">
									<span class="polisLabel">Wijzigingsdatum :</span>
									<span data-bind="text: wijzigingsDatum"></span>
								</div>
								<div data-bind="if: prolongatieDatum">
									<span class="polisLabel">Prolongatie :</span>
									<span data-bind="text: prolongatieDatum"></span>
								</div>
								<div data-bind="if: maatschappij">
									<span class="polisLabel">Maatschappij :</span>
									<span data-bind="text: maatschappij"></span>
								</div>
								<div data-bind="if: premie">
									<span class="polisLabel">Premie :</span>
									<span data-bind="text: premie"></span>
								</div>
								<div data-bind="if: betaalfrequentie">
									<span class="polisLabel">Betaalfrequentie :</span>
									<span data-bind="text: betaalfrequentie"></span>
								</div>
								<div data-bind="if: bedrijf">
									<span class="polisLabel">Bedrijf :</span>
									<span data-bind="text: bedrijf"></span>
								</div>
									
								<div id="bijlages2" class="bijlages" data-bind="foreach: bijlages, visible: bijlages().length > 0">
									<div>
										<span class="polisLabel">Bijlage :</span>
										<a data-bind="attr:{href: url}, title: bestandsNaam, text: bestandsNaam" target="_blank"></a>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="toevoegenPolis">
			<select id="verzekeringsMaatschappijen" name="verzekeringsMaatschappijen"></select>
			<select id="soortVerzekering" name="soortVerzekering">
				<option value="">Kies een soort verzekering...</option>
				<option>Aansprakelijkheid</option>
				<option>Auto</option>
				<option>Brom-/Snorfiets</option>
				<option>Camper</option>
				<option>Doorlopende Annulering</option>
				<option>Doorlopende Reis</option>
				<option>Fiets</option>
				<option>Inboedel</option>
				<option>Leven</option>
				<option>Mobiele apparatuur</option>
				<option>Motor</option>
				<option>Ongevallen</option>
				<option>Pleziervaartuigen</option>
				<option>Recreatie</option>
				<option>Rechtsbijstand</option>
				<option>Reis</option>
				<option>Woonhuis</option>
				<option>Zorg</option>
			</select>
			<select id="soortVerzekeringAlles" name="soortVerzekeringAlles" style="display:none;">
				<option value="">Kies een soort verzekering...</option>
				<option>Aansprakelijkheid</option>
				<option>Auto</option>
				<option>Brom-/Snorfiets</option>
				<option>Camper</option>
				<option>Doorlopende Annulering</option>
				<option>Doorlopende Reis</option>
				<option>Fiets</option>
				<option>Inboedel</option>
				<option>Leven</option>
				<option>Mobiele apparatuur</option>
				<option>Motor</option>
				<option>Ongevallen</option>
				<option>Pleziervaartuigen</option>
				<option>Recreatie</option>
				<option>Rechtsbijstand</option>
				<option>Reis</option>
				<option>Woonhuis</option>
				<option>Zorg</option>
			</select>
			<form enctype="multipart/form-data">
				<input class="form-control" type="text" id="polisNummer" name="polisNummer" placeholder="Polisnummer..." maxlength="25" />
				<input class="form-control" type="text" id="premie" placeholder="Premie..."  />
				<input class="form-control" type="text" id="ingangsDatumString" placeholder="Ingangs datum..." />
				<input class="form-control" type="text" id="wijzigingsdatumString" placeholder="Wijzigingsdatum..." />
				<input class="form-control" type="text" id="prolongatiedatumString" placeholder="Prolongatiedatum..." />
				<div id="div_betaalfrequentie">
					<select id="betaalfrequentie">
						<option value="">Betaalfrequentie...</option>
						<option>Maand</option>
						<option>Kwartaal</option>
						<option>Half jaar</option>
						<option>Jaar</option>
					</select>
				</div>
				<select id="bedrijfBijPolis" data-bind="foreach: bedrijvenVoorPolis, visible: bedrijven().length > 0">
					<option data-bind="text: naam, value: id"></option>
				</select>
				<input type="file" id="file" name="file" />
			</form>
			<button id="opslaanPolis" data-bind="click: $root.voegPolisToe">Opslaan</button>
			<progress style="display:none;"></progress>
			<script>
				$('#opslaanPolis').click(function(){
			    	verbergMeldingen();
	            	var polis = {
		            	relatie : $('#id').val(),
		            	premie : $('#premie').val().replace(",", "."),
						maatschappij : $('#verzekeringsMaatschappijen').val(),
						soortVerzekering : $('#soortVerzekering').val(),
						polisNummer : $('#polisNummer').val(),
						ingangsDatumString : $('#ingangsDatumString').val(),
						wijzigingsdatumString : $('#wijzigingsdatumString').val(),
						prolongatiedatumString : $('#prolongatiedatumString').val(),
						bedrijf : $('#bedrijfBijPolis').val(),
						betaalfrequentie : $('#betaalfrequentie').val()
	            	}
	            	var json = JSON.stringify(polis);
 					$.ajax({
						type: "POST",
						url: '../dejonge/rest/medewerker/polis/opslaan',
						contentType: "application/json",
			            data: json,
			            success: function(data) {
			            	$('progress').show();
							var formData = new FormData($('form')[0]);
							uploadBestand(formData, '../dejonge/rest/medewerker/polis/upload');
			        	},
						error: function (data) {
							plaatsFoutmelding(data);
						}
			    	});
				});
			</script>
		</div>
		<div id="overizchtBijlages">
			<table class="table">
				<tr>
					<th>Soort</th>
					<th>Bijlage</th>
				</tr>
				<tbody data-bind="foreach: lijstBijlages">
					<tr>
						<td data-bind="text: soortBijlage"></a></td>
						<td><a data-bind="attr:{href: url}, title: bestandsNaam, text: bestandsNaam" target="_blank"></a></td>
					</tr>
				</tbody>
			</table>
		</div>
		<div id="schades">
			<div id="schadesHerhaal" data-bind="foreach: schades, visible: schades().length > 0">
				<div class="panel-group" id="accordion">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4>
								<a data-toggle="collapse" data-parent="#accordion" data-bind="attr:{href: idDivLink}, text: soortSchade"></a>
							</h4>
						</div>
						<div data-bind="attr:{id: idDiv}" class="panel-collapse collapse">
							<div class="panel-body">
							    <div data-bind="text: soortSchade" />
							    <div data-bind="text: id" />
							    <div data-bind="text: polis" />
							    <div data-bind="text: schadeNummerMaatschappij" />
							    <div data-bind="text: schadeNummerTussenPersoon" />
							    <div data-bind="text: locatie" />
							    <div data-bind="text: statusSchade" />
							    <div data-bind="text: datumTijdSchade" />
							    <div data-bind="text: datumTijdMelding" />
							    <div data-bind="text: datumAfgehandeld" />
							    <div data-bind="text: eigenRisico" />
							    <div data-bind="text: omschrijving" />

								<div id="opmerkingenBijSchade" data-bind="foreach: opmerkingen, visible: opmerkingen().length > 0">
								    <div data-bind="text: tijd" />
								    <div data-bind="text: medewerker" />
								    <div data-bind="text: opmerking" />
								</div>

							</div>
						</div>
			    	</div>
			    </div>
			</div>
		</div>
		<div id="schadeMelden">
			<h4>Schademeldingen</h4>
			<div class="form-group">
				<label for="polisVoorSchademelding">Verzekering</label>
				<select id="polisVoorSchademelding" data-bind="foreach: polisVoorSchademelding, visible: polissen().length > 0">
					<option id="polisVoorSchade" data-bind="text: soort, value: id"></option>
				</select>
			</div>
			<div class="form-group">
				<label for="schadeNummerMaatschappij">Schadenummer Maatschappij</label>
				<input class="form-control" type="text" id="schadeNummerMaatschappij" name="schadeNummerMaatschappij" />
			</div>
			<div class="form-group">
				<label for="schadeNummerTussenpersoon">Schadenummer Tussenpersoon</label>
				<input class="form-control" type="text" id="schadeNummerTussenpersoon" name="schadeNummerTussenpersoon" />
			</div>
			<div class="form-group">
				<label for="soortSchade">Soort schade</label>
				<input class="form-control" type="text" id="soortSchade" name="soortSchade" />
			</div>
			<div class="form-group">
				<label for="locatieSchade">Locatie schade</label>
				<input class="form-control" type="text" id="locatieSchade" name="locatieSchade" />
			</div>
			<div class="form-group">
				<label for="statusSchade">Status schade</label>
				<select id="statusSchade" name="statusSchade"></select>
			</div>
			<div class="form-group">
				<label for="datumTijdSchade">Datum tijd schade</label>
				<input class="form-control" type="text" id="datumTijdSchade" name="datumTijdSchade" placeholder="dd-mm-eejj uu:mm" />
			</div>
			<div class="form-group">
				<label for="datumTijdMelding">Datum tijd melding</label>
				<input class="form-control" type="text" id="datumTijdMelding" name="datumTijdMelding" placeholder="dd-mm-eejj uu:mm" />
			</div>
			<div class="form-group">
				<label for="datumAfgehandeld">Datum afgehandeld</label>
				<input class="form-control" type="text" id="datumAfgehandeld" name="datumAfgehandeld" placeholder="dd-mm-eejj" />
			</div>
			<div class="form-group">
				<label for="eigenRisico">Eigen risico</label>
				<input class="form-control" type="text" id="eigenRisico" name="eigenRisico" />
			</div>
			<div class="form-group">
				<label for="omschrijving">Omschrijving</label>
				<textarea class="form-control" id="omschrijving" name="omschrijving" style="width:600px; height:200px;"></textarea>
			</div>
			<div class="form-group" id="uploadSchade1">
				<label for="file">&nbsp;</label>
				<input type="file" id="fileSchade1File" name="fileSchade1File" onchange="nieuweSchadeUpload(1);" />
			</div>
			<div class="form-group" id="uploadSchade2" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade2File" name="uploadSchade2File" onchange="nieuweSchadeUpload(2);" />
			</div>
			<div class="form-group" id="uploadSchade3" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade3File" name="uploadSchade3File" onchange="nieuweSchadeUpload(3);" />
			</div>
			<div class="form-group" id="uploadSchade4" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade4File" name="uploadSchade4File" onchange="nieuweSchadeUpload(4);" />
			</div>
			<div class="form-group" id="uploadSchade5" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade5File" name="uploadSchade5File" onchange="nieuweSchadeUpload(5);" />
			</div>
			<div class="form-group" id="uploadSchade6" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade6File" name="uploadSchade6File" onchange="nieuweSchadeUpload(6);" />
			</div>
			<div class="form-group" id="uploadSchade7" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade7File" name="uploadSchade7File" onchange="nieuweSchadeUpload(7);" />
			</div>
			<div class="form-group" id="uploadSchade8" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade8File" name="uploadSchade8File" onchange="nieuweSchadeUpload(8);" />
			</div>
			<div class="form-group" id="uploadSchade9" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade9File" name="uploadSchade9File" onchange="nieuweSchadeUpload(9);" />
			</div>
			<div class="form-group" id="uploadSchade10" style="display:none;">
				<label for="file">&nbsp;</label>
				<input type="file" id="uploadSchade10File" name="uploadSchade10File" onchange="nieuweSchadeUpload(10);" />
			</div>
			<script>
				function nieuweSchadeUpload(nummer){
					$('#uploadSchade' + ++nummer).show();
				}
			</script>
			<div class="form-group">
				<label for="schadeMeldingOpslaan">&nbsp;</label>
				<button class="btn btn-primary" id="schadeMeldingOpslaan" data-bind="click: $root.voegPolisToe">Opslaan</button>
			</div>
		</div>
	</div>
</div>
